# SAM

Dumps SAM credentials for each target system using a heavily modified version of Invoke-[NTLMExtract.ps1](https://raw.githubusercontent.com/BC-SECURITY/Empire/main/empire/server/data/module\_source/credentials/Invoke-NTLMExtract.ps1).

For each system output is stored in $pwd\PME\PME\SAM\\

### **Supported Methods**

* WMI
* WinRM
* PsExec

### **Optional Parameters**



<table><thead><tr><th width="170">Parameter</th><th width="131.33333333333331">Value</th><th>Description</th></tr></thead><tbody><tr><td>-Option</td><td>Parse</td><td>Parses output from each system. Checks for which SAM hashes are valid on multiple systems and then displays all unique hashes in a hashcat friendly format</td></tr><tr><td>-ShowOutput</td><td>N/A</td><td>Displays each targets output to the console</td></tr></tbody></table>

### Usage

{% code overflow="wrap" %}
```powershell
# Standard execution
PsMapExec -Username [User] -Password [Pass] -targets [All] -Module SAM -Method [Method] -ShowOutput
```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

{% code overflow="wrap" %}
```powershell
# With Parsing
PsMapExec -Username [User] -Password [Pass] -targets [All] -Module SAM -Method [Method] -Option Parse
```
{% endcode %}

The parsing option will parse the results from each SAM dump and display hashes which are reused across different systems.&#x20;

The output appends the system name from which the hash has been pulled from to the name for easy identification.

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>
